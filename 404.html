export default {
  fetch(request) {
    const url = new URL(request.url);
    const code = url.pathname.replace("/", "").replace(".mp4", "");

    if (!code || code.length < 5) {
      return new Response("Video not found", { status: 404 });
    }

    const videoURL = `https://cdn.videy.co/${code}1.mp4`;

    const html = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Video Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
  margin:0;
  background:#000;
}
video{
  width:100vw;
  height:100vh;
  object-fit:cover;
}
.banner{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  z-index:10;
}
</style>
</head>
<body oncontextmenu="return false">

<video autoplay playsinline controls
controlsList="nodownload noplaybackrate"
disablePictureInPicture>
  <source src="${videoURL}" type="video/mp4">
</video>

<div class="banner">
<script>
atOptions={
'key':'fb6b5bdf78a05e27cfbc26d861c4ce15',
'format':'iframe',
'height':50,
'width':320,
'params':{}
};
</script>
<script src="https://possessedannihilation.com/fb6b5bdf78a05e27cfbc26d861c4ce15/invoke.js"></script>
</div>

<script>
document.addEventListener("keydown",e=>{
  if(e.keyCode==123) e.preventDefault();
});
</script>

</body>
</html>
`;

    return new Response(html, {
      headers: { "content-type": "text/html;charset=UTF-8" },
    });
  }
}
